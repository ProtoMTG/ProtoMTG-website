<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="ProtoMTG: Prototypical Multi-Task Learning for the Generation of Multiple Stained Immunohistochemical Images">
  <meta name="keywords" content="Multi-Task, prototype">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ProtoMTG</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">
            ProtoMTG: ProtoMTG: Prototypical Multi-Task Learning for the Generation of Multiple Stained Immunohistochemical Images
          </h1>
          <!-- <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a >Junjie Zhou</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://zucc.zju.edu.cn/2022/0322/c54377a2509625/page1.htm">Jianpeng Sheng</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="http://parnec.nuaa.edu.cn/zhangdq/">Daoqiang Zhang</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://faculty.nuaa.edu.cn/shaowei/zh_CN/index/180018/list/index.htm">Wei Shao</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Nanjing University of Aeronautics and Astronautics,</span>
            <span class="author-block"><sup>2</sup>Zhejiang University</span>
          </div> -->

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <!-- <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span> -->
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/ProtoMTG/ProtoMTG"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/ProtoMTG/ProtoMTG/releases/tag/v1.0"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
      
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4">mIHC markers</h2>
        <img src="./static/images/mIHC.jpg"
               class="interpolation-image"
               alt="Interpolate start reference image."/>
        <br>
        <br>
        <h2 class="title is-4">Abstract</h2>
        <div class="content has-text-justified">

          <p>
            Multiplex immunohistochemistry (mIHC) has potential to asses the complex tumor microenvironment
            by simultaneously detecting multiple markers within a single tissue section, however,
            the acquisition of mIHC images in clinical labs are both time-consuming and costly.
            Hence, applying machine learning-based virtual staining techniques for rapid generation of different mIHC bio-markers has become a considerable alternative.
            The existing bio-image based virtual staining models generate the distribution of different markers independently, which has limited explainable ability and overlooks the fact that the exploration of potential interrelationships among these markers can help determine the localization of each individual marker.
    
            To address the above issues, we propose an explainable prototypical multi-task learning framework 
            (i.e., ProtoMTG) to simultaneously generate multiple mIHC markers from the DAPI staining of 
            nuclei. Specifically, ProtoMTG involves a multi-task prototype layer that can capture the 
            relationship among different virtual staining tasks by learning the shared and task-specific 
            prototypes. Then, in the proto-attention layer, both task-specific and shared prototypes 
            will be re-weighted and combined to instruct the generation of different mIHC markers. 
            In ProtoMTG, we also design the novel prototypical activation loss and diversity loss to 
            learn better prototype representation for the virtual staining task. To evaluate the performance
            of our method, we develop three benchmark mIHC datasets from different organs (i.e., colon,
            liver and stomach)  of humans. The experimental results indicate that our method can not only outperform
            the existing image generation models, but also have good explainable ability for the virtual
            staining of mIHC markers.

          </p>
          
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Image. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Hello</h2>
          <img src="./static/images/mIHC.jpg"
               class="interpolation-image"
               alt="Interpolate start reference image."/>
        </div>
      </div>
    </div> -->

    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">

    <!-- Animation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Overview of ProtoMTG</h2>
          <img src="./static/images/figure_2.jpg"
            class="interpolation-image"
            alt="Interpolate start reference image."/>
      </div>
    </div>
    <!--/ Animation. -->

  </div>
</section>

<section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Data Acquisition</h2>
            <div class="content has-text-justified">

            <p>
                mIHC experiment: Samples from patients were analyzed with IHC for positivity for HLA-DR, CD45RO, Vimentin and CD68.
                <br>
                Deparafinization: Place the sections in xylene for 10 min twice and 95% alcohol, 85% alcohol, and 75% alcohol for 5 min insequence, followed by PBS wash. Antigen retrieval: The tissue slices were boiled in antigen retrieval bufer for 10 min and keptwarm for 30 min. After cooling at room temperature for 30 min, the slides were taken out and washed with PBS three times for 3 min each. Endoaenous peroxidase blocking: put the slides in 3\% hydrogen peroxide solution and incubate at room temper-ature for 10 min in the dark, then wash with PBs 3 times. Blocking: Drop the sections with Super Blocker and incubate at roomtemperature for 30 min. Primary antibody incubation: Drop the primary antibody diluted in proportion with the primary antiboddiluent on the tissue. Sections were incubated overight at four C in a humidified chamber. Secondary antibody incubation:After a 3-time PBS wash, a primary antibody host-specific secondary antibody solution was added dropwise to cover the tissueand incubated at room temperature for 30 min. At last, color development was performed with a DAB color developmentsolution.
                
                The collection of data was approved by an IRB.
                
            </p>
        </div>
      </div>
    </div>
  </section>
  

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Results</h2>
          <img src="./static/images/results.jpg"
            class="interpolation-image"
            alt="Interpolate start reference image."/>
      </div>
    </div>
  </div>
</section>

<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{zhou2023a2summ,
  author    = {Junjie Zhou, Jianpeng Sheng, Daoqiang Zhang, Wei Shao},
  title     = {ProtoMTG: Prototypical Multi-Task Learning for Generating Immunohistochemical Images from DAPI Staining of Nuclei},
  journal   = {CVPR},
  year      = {2024},
}</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <!-- <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a> -->
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>